# BRS-Emulator: BrightScript 2D API Emulator

## The Repository

This repository extends [**brs**](https://github.com/sjbarag/brs), a _command line interpreter_ for **BrightScript** language, by implementing the **Draw 2D API** components (`roScreen`, `roCompositor`, `roRegion`, etc.) and several other **BrightScript** components allowing a full channel execution over an **HTML5 Canvas**, including emulation of the Roku remote control. We try to keep both projects synchronized as much as possible, but as there are scope differences not all implementations from **brs** will be merged here and vice-versa.

### So can I use this to watch TV without a Roku?

Nope! Neither projects, **brs** or **brs-emu**, currently has any intention of emulating the Roku OS user interface, integrating with the Roku store, or emulating media content playback.  Although **brs-emu** project runs channels with user interface, it does only supports the **2D API** components, mostly for **game development**, see [Current Limitations](docs/limitations.md) page for full details on what is out of scope.

<p align="center">
<img alt="Emulator Web and Desktop" src="docs/images/screenshots.png?raw=true"/>
</p>

## Technology and Compatibility

This emulator is bundled as a **[Webpack](https://webpack.js.org/)** Javascript library that runs as a **[Web Worker](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers)**, and it uses features like [SharedArrayBuffer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer) and [OffScreenCanvas](https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas), that are _bleeding edge_ in the browser engines implementation, because of that, at this moment, it can only be executed in [Chromium](https://www.chromium.org/Home) based browsers, like [Chrome](https://www.google.com/chrome/), [Brave](https://brave.com/download/), [Opera](https://www.opera.com/), [Edge Chromium](https://www.microsoft.com/en-us/edge) or embedded on an [Electron](https://electronjs.org/) application. 

The **BrightScript 2D API Emulator** is a full client-side library, nothing is sent or processed in the server side. In addition to the included sample **web application**, every release also includes a multi-platform **desktop application** (Windows, Linux & macOS) that uses the same library generated by this project.

The desktop app, introduces several aditional features, such as the **full screen** support, **ECP** (External Control Protocol) and **Remote Console** servers to allow integration with 3rd party development tools like the [VSCode BrightScript Extension](https://marketplace.visualstudio.com/items?itemName=celsoaf.brightscript). The Electron app source code and documentation is available in another repository, located at https://github.com/lvcabral/brs-emu-app.

## Contributing

There are many ways in which you can participate in the project, read documents below to know the details:

* [How to contribute](docs/contributing.md)
* [How to build from source](docs/build-from-source.md)

## Usage

If you just want to try the emulator, not downloading or installing anything, then go to the demo website at: https://lvcabral.com/brs

### Web Application
As mentioned above, this repo provides a sample web appplication for testing the emulator, located under the `app` folder. The application cannot be run as pure HTML page, because some functionalities used by the emulator have security restrictions on the browser engine, so you will need a web server to run it. For that you can use `Apache`, `IIS` or any simpler web server, but please note that starting from **Chrome** version **92**, the emulator web app will require to be hosted with [COOP and COEP custom headers](https://developer.chrome.com/blog/enabling-shared-array-buffer/) to allow isolation and enable usage of **ShareArrayBuffer**. More information visit: https://developer.chrome.com/blog/enabling-shared-array-buffer/

### Desktop Application

You can also run the emulator as a desktop application, download and install the specific OS package from the [latest release](https://github.com/lvcabral/brs-emu/releases). For usage documentation check the [app repository](https://github.com/lvcabral/brs-emu-app).

### Games and Demos

You can try the emulator by running one of the demonstration channels included in the repository, these are pre-configured as _clickable icons_ on `index.html`. In addition to those, you can load your own code, either as a single **.brs** file or a channel **.zip package**. Below there is a list of tested games that are publicly available with source code, download the `zip` files and have fun!

*   [Prince of Persia for Roku](https://github.com/lvcabral/Prince-of-Persia-Roku) port by Marcelo Lv Cabral - Download [zip file](https://github.com/lvcabral/Prince-of-Persia-Roku/releases/download/v0.18.3778/Prince-of-Persia-Roku-018.zip)
*   [Lode Runner for Roku](https://github.com/lvcabral/Lode-Runner-Roku) remake by Marcelo Lv Cabral - Download [zip file](https://github.com/lvcabral/Lode-Runner-Roku/releases/download/v0.18.707/Lode-Runner-Roku-018.zip)
*   [Retaliate](https://github.com/lvcabral/retaliate-roku) game by Romans I XVI - Download [zip file](https://github.com/lvcabral/retaliate-roku/releases/download/v1.7.0-emu/retaliate-brs-emu.zip)

### Note for BrightScript Developers

You can see the debug messages from `print` statements in your code using the _browser console_, just make sure you open the _Developer Tools (Ctrl+Shift+i)_ before loading your channel package or brs file. Exceptions from the emulator will be shown there too. If your code does show an error in some scenario not listed on the [limitations documentation](docs/limitations.md), feel free to [open an issue](https://github.com/lvcabral/brs-emu/issues).

## Author Links
- My website is [https://lvcabral.com](https://lvcabral.com)
- My twitter is [@lvcabral](https://twitter.com/lvcabral)
- My podcast is [PODebug Podcast](http://podebug.com)
- Check my other [GitHub repositories ](https://github.com/lvcabral)

## License

Copyright Â© Marcelo Lv Cabral. All rights reserved.

Licensed under the [MIT](LICENSE) license.
